# åˆ†æ®µé˜ˆå€¼é…ç½®è¯´æ˜

## ğŸ“‹ åŠŸèƒ½è¯´æ˜

v2.5.7æ–°å¢äº†**å¯é…ç½®çš„åˆ†æ®µé˜ˆå€¼**ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰ä½•æ—¶å¯ç”¨åˆ†æ®µå¹¶è¡Œç¿»è¯‘ã€‚

---

## ğŸ¯ é…ç½®é¡¹

### é…ç½®åç§°
`pipeline_segment_threshold`

### é»˜è®¤å€¼
`15`

### è¯´æ˜
- **ä½œç”¨**ï¼šæ§åˆ¶ç« èŠ‚åˆ†æ®µçš„é˜ˆå€¼
- **é€»è¾‘**ï¼š
  - ç« èŠ‚é¡µæ•° â‰¤ é˜ˆå€¼ â†’ ä¸åˆ†æ®µï¼Œä½¿ç”¨å®Œæ•´æ»šåŠ¨çª—å£ä¸Šä¸‹æ–‡
  - ç« èŠ‚é¡µæ•° > é˜ˆå€¼ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆæ®µæ•°=Line2å¹¶å‘æ•°ï¼‰

---

## âš™ï¸ é…ç½®æ–¹å¼

### æ–¹æ³•1ï¼šé€šè¿‡UIé…ç½®ï¼ˆæ¨èï¼‰

1. æ‰“å¼€æ¼«ç”»ç¿»è¯‘å™¨UI
2. è¿›å…¥è®¾ç½®é¡µé¢
3. æ‰¾åˆ° **"åˆ†æ®µé˜ˆå€¼(ç« èŠ‚é¡µæ•°>æ­¤å€¼å¯ç”¨åˆ†æ®µ)"** é…ç½®é¡¹
4. è®¾ç½®ä½ æƒ³è¦çš„é˜ˆå€¼ï¼ˆå»ºè®®èŒƒå›´ï¼š10-30ï¼‰
5. ä¿å­˜è®¾ç½®

### æ–¹æ³•2ï¼šé€šè¿‡é…ç½®æ–‡ä»¶

ç¼–è¾‘é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ï¼Œæ·»åŠ æˆ–ä¿®æ”¹ï¼š

```bash
pipeline_segment_threshold=20
```

### æ–¹æ³•3ï¼šé€šè¿‡ä»£ç 

åœ¨ `desktop_qt_ui/core/config_models.py` ä¸­ä¿®æ”¹é»˜è®¤å€¼ï¼š

```python
class CliSettings(BaseModel):
    # ...
    pipeline_segment_threshold: int = 20  # ä¿®æ”¹è¿™é‡Œçš„é»˜è®¤å€¼
```

---

## ğŸ“Š é˜ˆå€¼é€‰æ‹©å»ºè®®

| é˜ˆå€¼ | é€‚ç”¨åœºæ™¯ | è¯´æ˜ |
|------|---------|------|
| **10** | æ¿€è¿›åˆ†æ®µ | 10é¡µä»¥ä¸Šå°±åˆ†æ®µï¼Œæœ€å¤§åŒ–å¹¶è¡Œ |
| **15** | é»˜è®¤æ¨è | å¹³è¡¡æ€§èƒ½å’Œä¸Šä¸‹æ–‡è´¨é‡ |
| **20** | ä¿å®ˆåˆ†æ®µ | æ›´å¤šç« èŠ‚ä½¿ç”¨å®Œæ•´ä¸Šä¸‹æ–‡ |
| **30** | ä»…å¤§ç« èŠ‚ | åªå¯¹è¶…å¤§ç« èŠ‚åˆ†æ®µ |
| **50+** | å‡ ä¹ä¸åˆ†æ®µ | å¤§éƒ¨åˆ†ç« èŠ‚éƒ½ç”¨å®Œæ•´ä¸Šä¸‹æ–‡ |

### é€‰æ‹©å»ºè®®

**é€‰æ‹©è¾ƒå°é˜ˆå€¼ï¼ˆ10-15ï¼‰**ï¼š
- âœ… ç¿»è¯‘é€Ÿåº¦æ›´å¿«
- âœ… é€‚åˆå¤§æ‰¹é‡ç¿»è¯‘
- âš ï¸ ä¸Šä¸‹æ–‡çª—å£è¾ƒå°

**é€‰æ‹©è¾ƒå¤§é˜ˆå€¼ï¼ˆ25-30ï¼‰**ï¼š
- âœ… æ›´å®Œæ•´çš„ä¸Šä¸‹æ–‡
- âœ… ç¿»è¯‘è´¨é‡å¯èƒ½æ›´å¥½
- âš ï¸ ç¿»è¯‘é€Ÿåº¦è¾ƒæ…¢

---

## ğŸ” å®é™…æ•ˆæœç¤ºä¾‹

### é˜ˆå€¼=15ï¼ˆé»˜è®¤ï¼‰

```
11é¡µç« èŠ‚ â†’ ä¸åˆ†æ®µï¼ˆå®Œæ•´ä¸Šä¸‹æ–‡ï¼‰
20é¡µç« èŠ‚ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆ3æ®µï¼‰
50é¡µç« èŠ‚ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆ3æ®µï¼‰
```

### é˜ˆå€¼=30

```
11é¡µç« èŠ‚ â†’ ä¸åˆ†æ®µï¼ˆå®Œæ•´ä¸Šä¸‹æ–‡ï¼‰
20é¡µç« èŠ‚ â†’ ä¸åˆ†æ®µï¼ˆå®Œæ•´ä¸Šä¸‹æ–‡ï¼‰
50é¡µç« èŠ‚ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆ3æ®µï¼‰
```

### é˜ˆå€¼=10

```
11é¡µç« èŠ‚ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆ3æ®µï¼‰
20é¡µç« èŠ‚ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆ3æ®µï¼‰
50é¡µç« èŠ‚ â†’ åˆ†æ®µå¹¶è¡Œï¼ˆ3æ®µï¼‰
```

---

## ğŸ“ æ—¥å¿—éªŒè¯

å¯åŠ¨ç¿»è¯‘åï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­çš„åˆ†æ®µä¿¡æ¯ï¼š

### ä¸åˆ†æ®µæ¨¡å¼
```log
ç« èŠ‚å›¾ç‰‡æ•°: 20 å¼ 
ç« èŠ‚é¡µæ•°â‰¤15ï¼Œä¸åˆ†æ®µï¼Œä½¿ç”¨å®Œæ•´æ»šåŠ¨çª—å£ä¸Šä¸‹æ–‡
å¯åŠ¨3ä¸ªLine2å·¥ä½œå™¨ï¼ˆéåˆ†æ®µï¼‰
```

### åˆ†æ®µæ¨¡å¼
```log
ç« èŠ‚å›¾ç‰‡æ•°: 20 å¼ 
ä½¿ç”¨åˆ†æ®µå¹¶è¡Œæ¨¡å¼: 3æ®µ
åˆ†æ®µç­–ç•¥: 3æ®µ (Line2å¹¶å‘æ•°=3)
  æ®µ0: é¡µ0-6 (7é¡µ)
  æ®µ1: é¡µ7-13 (7é¡µ)
  æ®µ2: é¡µ14-19 (6é¡µ)
ä¸º3ä¸ªæ®µåˆ›å»ºç‹¬ç«‹é˜Ÿåˆ—
å¯åŠ¨3ä¸ªLine2æ®µå·¥ä½œå™¨ï¼ˆåˆ†æ®µå¹¶è¡Œï¼‰
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ä»£ç ä½ç½®

1. **é…ç½®å®šä¹‰**ï¼š`desktop_qt_ui/core/config_models.py`
   ```python
   pipeline_segment_threshold: int = 15
   ```

2. **é…ç½®è¯»å–**ï¼š`manga_translator/manga_translator.py`
   ```python
   self.pipeline_segment_threshold = _safe_int(
       params.get('pipeline_segment_threshold', 15), 15
   )
   ```

3. **åˆ†æ®µåˆ¤æ–­**ï¼š`manga_translator/manga_translator.py`
   ```python
   def _should_use_segments(self, total_images):
       return total_images > self.pipeline_segment_threshold
   ```

4. **UIæ˜¾ç¤ºåç§°**ï¼š`desktop_qt_ui/app_logic.py`
   ```python
   "pipeline_segment_threshold": "åˆ†æ®µé˜ˆå€¼(ç« èŠ‚é¡µæ•°>æ­¤å€¼å¯ç”¨åˆ†æ®µ)"
   ```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é˜ˆå€¼èŒƒå›´**ï¼šå»ºè®®è®¾ç½®åœ¨ 5-50 ä¹‹é—´
2. **ä¸å¹¶å‘æ•°é…åˆ**ï¼š
   - åˆ†æ®µæ•° = Line2å¹¶å‘æ•°
   - å¦‚æœLine2å¹¶å‘=3ï¼Œåˆ™åˆ†æˆ3æ®µ
3. **APIé™æµ**ï¼šé˜ˆå€¼è¿‡å°å¯èƒ½å¯¼è‡´æ›´å¤šå¹¶å‘è¯·æ±‚ï¼Œæ³¨æ„APIé™æµ
4. **å†…å­˜å ç”¨**ï¼šé˜ˆå€¼è¿‡å°ä¼šåˆ›å»ºæ›´å¤šç‹¬ç«‹é˜Ÿåˆ—å’Œå·¥ä½œå™¨

---

## ğŸ¯ æ¨èé…ç½®ç»„åˆ

### å¿«é€Ÿç¿»è¯‘ï¼ˆå¤§æ‰¹é‡ï¼‰
```bash
pipeline_segment_threshold=10
pipeline_line2_concurrency=5
pipeline_translation_batch_size=3
```

### å¹³è¡¡æ¨¡å¼ï¼ˆæ¨èï¼‰
```bash
pipeline_segment_threshold=15
pipeline_line2_concurrency=3
pipeline_translation_batch_size=3
```

### é«˜è´¨é‡ç¿»è¯‘
```bash
pipeline_segment_threshold=30
pipeline_line2_concurrency=2
pipeline_translation_batch_size=2
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [v2.5.7-åˆ†æ®µå¹¶è¡Œç¿»è¯‘è¯´æ˜.md](./v2.5.7-åˆ†æ®µå¹¶è¡Œç¿»è¯‘è¯´æ˜.md) - å®Œæ•´æŠ€æœ¯æ–‡æ¡£
- [å››çº¿æµæ°´çº¿æ¶æ„è¯´æ˜.md](./å››çº¿æµæ°´çº¿æ¶æ„è¯´æ˜.md) - æµæ°´çº¿æ¶æ„è¯¦è§£

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-16  
**ä½œè€…**: Windsurf Cascade

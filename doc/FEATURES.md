# 功能特性

本文档介绍漫画图片翻译器的核心功能和可视化编辑器。

---

## ✨ 核心功能

### 文本处理

- **🔍 智能文本检测**：自动识别漫画中的文字区域
- **📝 多语言 OCR**：支持日语、中文、英语等多种语言识别
- **🌐 30+ 翻译引擎**：离线翻译器（Sugoi、NLLB 等）、在线翻译器（Google Gemini、OpenAI、DeepL 等）
- **🎯 高质量翻译**：使用多模态 AI 模型（GPT-4o、Gemini），结合图片上下文进行翻译，准确率更高
- **🎨 图像修复**：自动擦除原文并智能填充背景
- **✍️ 智能嵌字**：自动排版译文，支持多种字体和样式
- **🤖 AI 断句**：支持 OpenAI、Gemini 翻译器的智能断句功能
- **📦 批量处理**：一次处理整个文件夹的图片
- **⚡ 流水线并行**：检测/OCR与翻译同时进行，大幅提升处理速度

### 流水线并行处理（Pipeline Mode）

**功能说明**：

传统翻译流程是串行的：
```
图片1: 检测→OCR→翻译→渲染 （等待）
图片2: 检测→OCR→翻译→渲染 （等待）
图片3: 检测→OCR→翻译→渲染
```

流水线并行模式将步骤分解，**在等待AI翻译时处理下一张图片**：
```
时刻1: 图片1检测+OCR
时刻2: 图片1翻译     | 同时 | 图片2检测+OCR
时刻3: 图片1渲染     | 同时 | 图片2翻译     | 同时 | 图片3检测+OCR
时刻4: 图片1完成   | 同时 | 图片2渲染     | 同时 | 图片3翻译
```

**优势**：
- ✅ **显著提速**：对于在线翻译器（OpenAI/Gemini/DeepL），速度提升 **30-50%**
- ✅ **资源充分利用**：GPU和API调用不再空闲等待
- ✅ **内存友好**：队列限制确保不会占用过多内存

**适用场景**：
- ⭐ **强烈推荐**：使用在线翻译器（OpenAI/Gemini/DeepL）时
- ✅ **有效**：批量处理多张图片（≥2张）
- ⛔ **不适用**：单张图片或导出原文模式

**启用方法**：
在"高级设置"标签页中勾选"流水线并行模式"即可。

---

## 🎨 可视化编辑器

提供强大的图形化编辑工具，支持精确调整翻译结果：

### 区域编辑

- **移动**：拖拽文本区域到任意位置
- **旋转**：使用旋转手柄进行 0-360° 精确旋转
- **变形**：顶点编辑、边缘调整、自由变形
- **编辑形状**：选中文本框后，点击工具栏的"编辑形状"按钮，在空白区域拖动对角线增加新的蓝框

> **💡 OCR 识别最佳实践**：建议在编辑器中调整文本框，确保**一个蓝框里只有一行字**，不然 48px 和 32px 可能无法正确识别到文字。

### 文本编辑

- **手动翻译**：直接编辑译文内容
- **样式调整**：字体、大小、颜色、对齐方式
- **方向控制**：水平/垂直文字方向

### 蒙版编辑

- **画笔工具**：手动绘制文本擦除区域
- **橡皮擦**：修正蒙版错误
- **蒙版优化**：自动优化擦除效果

### 高级功能

- **撤销/重做**：完整的操作历史管理
- **批量操作**：多选、批量修改属性
- **实时预览**：即时查看翻译效果

---

## 🖥️ 用户界面

- **现代化设计**：基于 PyQt6 的流畅界面
- **拖拽支持**：直接拖拽图片到窗口
- **实时日志**：查看翻译进度和错误信息
- **配置管理**：保存和加载自定义配置

---

## 🌐 翻译器支持

### 离线翻译器（无需网络）

| 翻译器 | 说明 |
|--------|------|
| **Sugoi** | 日→英翻译（默认） |
| **NLLB** | 多语言翻译 |
| **NLLB (Big)** | 大模型多语言翻译 |
| **M2M100** | 多语言翻译 |
| **M2M100 (Big)** | 大模型多语言翻译 |
| **mBART50** | 多语言翻译 |
| **JParaCrawl** | 日语翻译 |
| **JParaCrawl (Big)** | 大模型日语翻译 |
| **Qwen2** | 通义千问翻译 |
| **Qwen2 (Big)** | 大模型通义千问翻译 |
| **离线翻译** | 通用离线翻译 |

### 在线翻译器（需要 API Key）

| 翻译器 | 说明 |
|--------|------|
| **Google Gemini** | Google Gemini 翻译 |
| **OpenAI** | OpenAI ChatGPT 翻译 |
| **DeepL** | DeepL 翻译 |
| **百度翻译** | 百度翻译 API |
| **有道翻译** | 有道翻译 API |
| **彩云小译** | 彩云小译 API |
| **Papago** | Naver Papago 翻译 |
| **Sakura** | Sakura 翻译 |
| **Groq** | Groq 翻译 |

### 高质量翻译器（需要 API Key，推荐）

| 翻译器 | 优势 |
|--------|------|
| **高质量翻译 OpenAI** | 使用 GPT-4o 等多模态模型，结合图片上下文翻译 |
| **高质量翻译 Gemini** | 使用 Gemini 多模态模型，结合图片上下文翻译 |

**高质量翻译器的优势**：
- 📸 **多模态理解**：AI 可以"看到"图片内容，理解上下文
- 🎯 **更准确**：结合图片信息，翻译更符合场景
- 📝 **批量处理**：一次发送多张图片，AI 理解整体剧情
- 🔧 **自定义提示词**：支持自定义翻译风格和术语表

### 其他选项

| 选项 | 说明 |
|------|------|
| **原文** | 不翻译，保留原文 |
| **无** | 仅检测和擦除文本，不翻译 |

---

## 🔤 OCR 模型

| 模型 | 说明 |
|------|------|
| **48px** | 默认模型，推荐使用 |
| **48px_ctc** | CTC 模型，识别准确率更高 |
| **mocr** | Manga OCR 专用模型 |
| **paddleocr** | PaddleOCR 引擎 |

---

## 🎨 图像处理

### 修复模型

| 模型 | 说明 |
|------|------|
| **lama_large** | 大型 LaMa 修复模型（推荐，效果最好） |
| **lama_mpe** | LaMa MPE 修复模型（速度快） |
| **default** | AOT 修复器（默认） |

### 超分辨率

| 功能 | 说明 |
|------|------|
| **waifu2x** | Waifu2x 超分模型（传统模型） |
| **realcugan** | Real-CUGAN 超分模型（推荐，效果更好，降噪能力强） |
| **超分倍数** | 支持 2x、3x、4x 放大 |
| **Real-CUGAN 模型** | 提供多种预训练模型：保守、无降噪、降噪1x/2x/3x、Pro 版本 |
| **分块处理** | 支持大图分块处理，降低显存占用 |
| **还原超分** | 翻译后恢复原始分辨率（避免图片变大） |

**Real-CUGAN 特点**：
- 📸 **高质量放大**：基于深度学习的超分辨率算法
- 🎯 **多档降噪**：支持无降噪、降噪1x/2x/3x、保守模式
- 💻 **显存友好**：分块处理大图，避免显存不足
- ⚡ **Pro 版本**：提供更高质量的超分效果

### 上色器

| 功能 | 说明 |
|------|------|
| **none** | 不上色（默认） |
| **其他上色模型** | 可选的上色功能 |

---

## 💾 字体设置

程序会自动加载 `fonts` 目录下的所有字体文件。

**添加自定义字体**：详见 [设置说明 - 如何添加自定义字体](SETTINGS.md#如何添加自定义字体)

---

## 🔧 高质量翻译提示词

支持自定义提示词来优化翻译风格和术语。

**添加自定义提示词**：详见 [设置说明 - 如何添加高质量提示词](SETTINGS.md#如何添加高质量提示词)


# 私有仓库同步工具使用指南

**仓库**: `https://gitee.com/long-xin12/manga-translator-ui`

---

## 🚀 快速开始

### 方法1：双击运行（推荐）

```
双击运行: 私有仓库同步.bat
```

运行后会提示：
1. **选择分支**（don 或 my-custom-features）
2. **选择操作**（推送 或 拉取）

---

## 📊 分支说明

### 🔹 don分支 - 流水线功能
- **包含**: 四线流水线 + v2.5.7分段并行翻译
- **用途**: 提交PR到GitHub
- **特点**: 纯净的流水线功能代码

### 🔹 my-custom-features分支 - UI功能
- **包含**: 漫画管理面板 + CBZ工具 + 其他UI增强
- **用途**: 个人UI功能开发
- **特点**: 不包含流水线，独立的UI功能集

---

## 📝 使用场景

### 场景1：推送流水线功能

```
1. 双击运行: 私有仓库同步.bat
2. 选择分支: 1 (don)
3. 选择操作: 1 (推送)
4. 完成！
```

### 场景2：拉取UI功能更新

```
1. 双击运行: 私有仓库同步.bat
2. 选择分支: 2 (my-custom-features)
3. 选择操作: 2 (拉取)
4. 完成！
```

### 场景3：推送UI新功能

```
1. 双击运行: 私有仓库同步.bat
2. 选择分支: 2 (my-custom-features)
3. 选择操作: 1 (推送)
4. 输入提交信息
5. 完成！
```

---

## 🎯 命令行使用

### PowerShell直接调用

```powershell
# 推送don分支
.\私有仓库同步.ps1 -Branch don -Action push

# 拉取my-custom-features分支
.\私有仓库同步.ps1 -Branch my-custom-features -Action pull

# 交互式（不指定参数，会提示选择）
.\私有仓库同步.ps1
```

---

## ✨ 功能特性

### 1. 智能分支管理
- ✅ 自动检测本地和远程分支
- ✅ 本地无分支时提示创建
- ✅ 自动切换到目标分支

### 2. 自动暂存/恢复
- ✅ 切换分支前自动暂存修改
- ✅ 操作完成后自动恢复
- ✅ 避免丢失未提交的修改

### 3. 远程仓库管理
- ✅ 自动检测远程仓库配置
- ✅ 未配置时提示添加
- ✅ URL格式验证

### 4. 友好的交互提示
- ✅ 彩色输出
- ✅ 清晰的分支说明
- ✅ 详细的错误提示

---

## 📋 输出示例

### 成功推送

```
========================================
私有仓库同步工具
========================================

请选择要同步的分支:
  1. don - 流水线功能（四线流水线+v2.5.7分段翻译）
  2. my-custom-features - UI功能（漫画管理面板+CBZ工具等）
========================================

请输入选择 (1/2): 1
[信息] 选择的分支: don - 流水线功能（四线流水线+v2.5.7分段翻译）

========================================
请选择操作:
  1. 推送 - 将本地修改推送到远程
  2. 拉取 - 从远程拉取最新修改
========================================

请输入选择 (1/2): 1

========================================
执行操作: 推送
========================================

[成功] 已在分支 'don'
[推送] 推送到 my-private/don...
[成功] 推送完成

[信息] 最近的提交:
* 953a4b9 - docs: 添加流水线和分段并行翻译的技术文档
* a123226 - chore: 更新配置示例文件
* 42a77d0 - feat: v2.5.7 分段并行翻译 + 可配置分段阈值

========================================
操作成功完成！
========================================
```

---

## ⚠️ 注意事项

### 1. 分支独立性
- don分支和my-custom-features分支**完全独立**
- 不要将它们合并
- 各自维护各自的功能

### 2. 推送前确认
- 确认当前在正确的分支
- 确认修改的内容正确
- 推送前建议先拉取最新版本

### 3. 冲突处理
如果拉取时出现冲突：
```bash
[警告] 恢复时发生冲突
[信息] 请手动解决冲突: git status
[信息] 解决后运行: git add . && git commit
```

**解决步骤**：
1. 运行 `git status` 查看冲突文件
2. 打开冲突文件手动解决
3. 运行 `git add .` 标记已解决
4. 运行 `git commit` 提交

---

## 🔧 高级用法

### 跳过分支选择直接推送

```powershell
# 推送don分支
.\私有仓库同步.ps1 -Branch don -Action push

# 推送my-custom-features分支
.\私有仓库同步.ps1 -Branch my-custom-features -Action push
```

### 查看远程分支状态

```bash
git ls-remote my-private
```

### 手动同步

```bash
# don分支
git checkout don
git push my-private don

# my-custom-features分支
git checkout my-custom-features
git push my-private my-custom-features
```

---

## 📚 相关文档

- **分支详情**: [Gitee私人仓库分支说明.md](./Gitee私人仓库分支说明.md)
- **流水线功能**: don分支包含完整流水线和v2.5.7文档
- **UI功能**: my-custom-features分支包含UI增强

---

## 🎉 总结

**使用要点**：
1. 双击 `私有仓库同步.bat` 运行
2. 根据提示选择分支和操作
3. 脚本自动处理其他事项

**分支选择建议**：
- 开发流水线功能 → 选择 `don`
- 开发UI功能 → 选择 `my-custom-features`
- 两个分支互不干扰

---

**版本**: v2.0  
**更新时间**: 2025-11-16 16:40  
**改进**: 支持双分支独立同步
